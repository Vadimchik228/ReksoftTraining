-- Создание Hash-индексов

-- students
CREATE INDEX idx_students_first_name_hash ON students USING HASH (first_name);
CREATE INDEX idx_students_last_name_hash ON students USING HASH (last_name);
CREATE INDEX idx_students_phone_number_hash ON students USING HASH (phone_number);
ANALYSE students;

-- results
CREATE INDEX idx_results_student_id_hash ON results USING HASH (student_id);
CREATE INDEX idx_results_subject_id_hash ON results USING HASH (subject_id);
CREATE INDEX idx_results_assessment_hash ON results USING HASH (assessment);
ANALYSE results;

-- subjects
CREATE INDEX idx_subjects_name_hash ON subjects USING HASH (name);
ANALYSE subjects;

-- specializations
CREATE INDEX idx_specializations_specialty_code_hash ON specializations USING HASH (specialty_code);
CREATE INDEX idx_specializations_full_name_hash ON specializations USING HASH (full_name);
ANALYSE specializations;

-- faculties
CREATE INDEX idx_faculties_name_hash ON faculties USING HASH (name);
ANALYSE faculties;

-- Проверка размеров индексов

-- students
SELECT pg_relation_size('idx_students_first_name_hash');
SELECT pg_relation_size('idx_students_last_name_hash');
SELECT pg_relation_size('idx_students_phone_number_hash');

-- results
SELECT pg_relation_size('idx_results_student_id_hash');
SELECT pg_relation_size('idx_results_subject_id_hash');
SELECT pg_relation_size('idx_results_assessment_hash');

-- subjects
SELECT pg_relation_size('idx_subjects_name_hash');

-- specializations
SELECT pg_relation_size('idx_specializations_specialty_code_hash');
SELECT pg_relation_size('idx_specializations_full_name_hash');

-- faculties
SELECT pg_relation_size('idx_faculties_name_hash');

-- Удаление индексов

-- students
DROP INDEX IF EXISTS idx_students_first_name_hash;
DROP INDEX IF EXISTS idx_students_last_name_hash;
DROP INDEX IF EXISTS idx_students_phone_number_hash;

-- results
DROP INDEX IF EXISTS idx_results_student_id_hash;
DROP INDEX IF EXISTS idx_results_subject_id_hash;
DROP INDEX IF EXISTS idx_results_assessment_hash;

-- subjects
DROP INDEX IF EXISTS idx_subjects_name_hash;

-- specializations
DROP INDEX IF EXISTS idx_specializations_specialty_code_hash;
DROP INDEX IF EXISTS idx_specializations_full_name_hash;

-- faculties
DROP INDEX IF EXISTS idx_faculties_name_hash;